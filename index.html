<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jurnal Guru Digital - Terintegrasi</title>
    <style>
        /* --- CSS STYLING (Layar) --- */
        body { font-family: Arial, sans-serif; background-color: #f0ffef; margin: 0; padding: 20px; }
        .container { max-width: 1200px; margin: auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); }
        
        /* JUDUL UTAMA LEBIH BESAR */
        h1.main-title { font-size: 2.5em; text-align: center; color: #1a75ff; margin-bottom: 20px; }

        /* INFORMASI HEADER (Identitas) */
        .info-header { 
            display: flex; flex-direction: column; gap: 5px; margin-bottom: 20px; 
            border: 1px solid #cceeff; padding: 15px; border-radius: 4px; 
            background-color: #e6f7ff; 
        }
        .info-header label { font-weight: bold; display: inline-block; width: 150px; }
        .info-item { display: flex; align-items: center; }
        .info-header input[type="text"] { flex-grow: 1; padding: 8px; border: 1px solid #99ccff; border-radius: 4px; box-sizing: border-box; }

        /* Master Siswa Section (DATABASE SISWA) */
        .master-siswa { border: 2px solid #28a745; padding: 20px; margin: 20px 0; border-radius: 8px; background-color: #e6ffe6; }
        .master-siswa textarea { width: 100%; height: 120px; padding: 10px; border: 1px solid #77dd77; border-radius: 4px; resize: vertical; font-family: monospace; font-size: 14px; box-sizing: border-box; }
        .master-siswa h3 { color: #28a745; margin-top: 0; }
        .master-siswa button { padding: 8px 15px; background-color: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; transition: background-color 0.3s; }

        /* Jurnal Table Styling (INPUT JURNAL) */
        .jurnal-table-container { overflow-x: auto; margin-top: 20px; }
        .jurnal-table { width: 100%; border-collapse: collapse; min-width: 900px; }
        
        /* WARNA PADA JUDUL TABEL DI LAYAR */
        .jurnal-table th { 
            background-color: #1a75ff; 
            color: white;
            padding: 12px 10px;
            text-align: center;
            border: 1px solid #0056b3;
            font-size: 14px;
        }

        .jurnal-table td { padding: 5px; border: 1px solid #ddd; vertical-align: top; }
        .jurnal-table input[type="text"], .jurnal-table input[type="date"], .jurnal-table input[type="number"], .jurnal-table select { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 3px; box-sizing: border-box; }
        .jurnal-table input[type="number"] { text-align: center; }

        /* Tombol Aksi */
        .btn-hapus { background-color: #dc3545; color: white; padding: 6px 10px; border-radius: 4px; border: none; cursor: pointer; }
        .btn-absen { background-color: #ff9900; color: white; padding: 6px 10px; border-radius: 4px; font-size: 12px; border: none; cursor: pointer;}
        .action-btn-group button { padding: 10px 15px; margin-right: 10px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; }
        .btn-add-agenda { background-color: #28a745; color: white; }
        .btn-save { background-color: #1a75ff; color: white; }
        .btn-print { background-color: #6c757d; color: white; }

        /* --- MODAL ABSENSI STYLES --- */
        .modal { position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.6); }
        .modal-content { background-color: #fefefe; margin: 5% auto; padding: 25px; border: 1px solid #888; width: 90%; max-width: 700px; border-radius: 8px; position: relative; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
        .close-button { color: #aaa; float: right; font-size: 30px; font-weight: bold; cursor: pointer; }
        .modal h3 { color: #1a75ff; }

        /* --- TANDA TANGAN SECTION --- */
        .ttd-section { display: flex; justify-content: space-between; margin-top: 50px; width: 100%; }
        .ttd-box { width: 45%; text-align: center; }
        .ttd-space { height: 80px; margin: 10px 0; }
        
        /* --- PRINT STYLING A4 & JUDUL TABEL BIRU --- */
        @media print {
            @page { size: A4; margin: 1cm; }
            body { width: 100%; margin: 0; padding: 0; font-size: 10pt; }
            body * { visibility: hidden; } 
            #printArea, #printArea * { visibility: visible; }
            #printArea { position: absolute; left: 0; top: 0; width: 100%; padding: 0; }
            .no-print { display: none; }

            .jurnal-table { width: 100%; border-collapse: collapse; border: 1px solid black; table-layout: fixed; }
            
            /* Judul Tabel BIRU di area cetak */
            .jurnal-table th { 
                background-color: #1a75ff !important; 
                color: white !important;
                border: 1px solid black; 
                padding: 8px 5px;
                font-size: 10pt;
                -webkit-print-color-adjust: exact; 
                print-color-adjust: exact;
            }
            .jurnal-table td { border: 1px solid black; background: white !important; color: black; padding: 5px; font-size: 9pt; word-wrap: break-word; }

            /* Penyesuaian lebar kolom agar tidak terpotong */
            #printTableBody th:nth-child(1) { width: 10%; } 
            #printTableBody th:nth-child(2) { width: 6%; }  
            #printTableBody th:nth-child(3) { width: 12%; } 
            #printTableBody th:nth-child(4) { width: 28%; } 
            #printTableBody th:nth-child(5) { width: 6%; }  
            #printTableBody th:nth-child(6) { width: 6%; }  
            #printTableBody th:nth-child(7) { width: 32%; }

            .ttd-section { justify-content: space-around; margin-top: 50px; }
            .ttd-box { width: 45%; text-align: center; font-size: 10pt; }
            .ttd-name { font-weight: bold; margin-top: 40px; margin-bottom: 2px; } /* Jarak setelah TTD space */
            .ttd-nip { margin: 2px 0; } /* Styling untuk NIP */
        }
    </style>
</head>
<body>

<div class="container">
    <div class="no-print">
        
        <h1 class="main-title">üìù Jurnal Harian Guru - Input</h1>

        <div class="info-header">
            <div class="info-item">
                <label>Nama Guru:</label>
                <input type="text" id="namaGuru" value="Rita Nurmala Dewi, S.Pd">
            </div>
            <div class="info-item">
                <label>NIP Guru:</label>
                <input type="text" id="nipGuru" value="19870817 201001 2 005">
            </div>
            <div class="info-item">
                <label>Mata Pelajaran:</label>
                <input type="text" id="mapel" value="Matematika">
            </div>
            <div class="info-item">
                <label>Nama Sekolah:</label>
                <input type="text" id="sekolah" value="SMK N 4 Tangerang">
            </div>
            <div class="info-item">
                <label>Tahun Pelajaran:</label>
                <input type="text" id="tahunPelajaran" value="2025/2026">
            </div>
            <div class="info-item">
                <label>Tempat Laporan (Kota):</label>
                <input type="text" id="tempatLaporan" value="Tangerang">
            </div>
            <hr style="width: 100%; margin: 10px 0;">
            <div class="info-item">
                <label>Nama Kepala Sekolah:</label>
                <input type="text" id="namaKepalaSekolah" value="Dr. Hj. Siti Fatimah, M.Pd.">
            </div>
            <div class="info-item">
                <label>NIP Kepala Sekolah:</label>
                <input type="text" id="nipKepalaSekolah" value="19650302 199003 2 001">
            </div>
        </div>

        <div class="master-siswa">
            <h3>üìö Master Data Kelas dan Siswa (DATABASE SISWA)</h3>
            <p>Masukkan data dengan format: **Kelas|Nama Siswa** (Setiap baris adalah siswa baru).</p>
            <p>Contoh: <code>X IPA 1|Ani Susanti</code> atau <code>X Mesin 2|Budi Hartono</code></p>
            <textarea id="masterSiswaList"></textarea>
            <button onclick="loadMasterData()">Load & Update Master Data</button>
            <p style="margin-top: 10px;">Kelas yang tersedia saat ini: <strong id="availableClasses">Belum dimuat</strong></p>
        </div>

        <hr>

        <h2>Input Jurnal Harian Baru</h2>
        <div class="jurnal-table-container">
            <table class="jurnal-table">
                <thead>
                    <tr>
                        <th style="width: 10%;">HARI / TANGGAL</th>
                        <th style="width: 8%;">JAM KE-</th>
                        <th style="width: 12%;">KELAS</th>
                        <th style="width: 25%;">MATERI & KEGIATAN</th>
                        <th style="width: 5%;">HADIR</th>
                        <th style="width: 5%;">TIDAK HADIR</th>
                        <th style="width: 25%;">NAMA SISWA TIDAK HADIR (S/I/A)</th>
                        <th style="width: 10%;">AKSI</th>
                    </tr>
                </thead>
                <tbody id="jurnalInputBody">
                    </tbody>
            </table>
        </div>
        
        <div class="action-btn-group">
            <button class="btn-add-agenda" onclick="tambahAgendaBerikutnya()">‚ûï Tambah Jurnal</button>
            <button class="btn-save" onclick="simpanAgenda()">üíæ Simpan</button>
        </div>

        <hr>
        
        <h2>Jurnal Tersimpan</h2>
        <div class="jurnal-table-container">
            <table class="jurnal-table">
                <thead>
                    <tr>
                        <th style="width: 10%;">TANGGAL</th>
                        <th style="width: 8%;">JAM KE-</th>
                        <th style="width: 12%;">KELAS</th>
                        <th style="width: 25%;">MATERI</th>
                        <th style="width: 5%;">Hadir</th>
                        <th style="width: 5%;">Absen</th>
                        <th style="width: 30%;">Detail Absen</th>
                        <th style="width: 5%;">Aksi</th>
                    </tr>
                </thead>
                <tbody id="jurnalTersimpanBody">
                    </tbody>
            </table>
        </div>
    </div>

    <div id="printArea">
        <h1 style="text-align: center; font-size: 1.8em;">LAPORAN JURNAL HARIAN GURU</h1>
        
        <div style="margin-bottom: 15px; font-size: 1.1em; border: 1px solid #ccc; padding: 10px;">
            <p style="margin: 3px 0;"><strong>Nama Guru:</strong> <span id="printNamaGuru"></span></p>
            <p style="margin: 3px 0;"><strong>Mata Pelajaran:</strong> <span id="printMapel"></span></p>
            <p style="margin: 3px 0;"><strong>Nama Sekolah:</strong> <span id="printSekolah"></span></p>
            <p style="margin: 3px 0;"><strong>Tahun Pelajaran:</strong> <span id="printTahunPelajaran"></span></p>
        </div>
        <hr>

        <h2>Jurnal Tersimpan</h2>
        <table class="jurnal-table" id="printTableBody">
            </table>

        <p style="text-align: right; margin-top: 30px;">
            <span id="ttdTempatTanggal"></span>
        </p>

        <div class="ttd-section">
            <div class="ttd-box">
                <p>Kepala Sekolah</p>
                <div class="ttd-space"></div>
                <p class="ttd-name" id="ttdNamaKepsek"></p>
                <p class="ttd-nip" id="ttdNipKepsek"></p>
            </div>

            <div class="ttd-box">
                <p>Guru Mata Pelajaran</p>
                <div class="ttd-space"></div>
                <p class="ttd-name" id="ttdNamaGuruTTD"></p>
                <p class="ttd-nip" id="ttdNipGuru"></p>
            </div>
        </div>

    </div>

    <div class="action-btn-group no-print" style="margin-top: 20px; text-align: center;">
        <button class="btn-print" onclick="cetakJurnal()">üñ®Ô∏è Cetak Jurnal</button>
    </div>
</div>

<div id="absensiModal" class="modal" style="display:none;">
    <div class="modal-content">
        <span class="close-button" onclick="closeModal()">&times;</span>
        <h3>Input Siswa Tidak Hadir Kelas: <span id="modalKelasTarget"></span></h3>
        <p style="font-size: 0.9em; color: #555;">Centang siswa yang **TIDAK HADIR** dan pilih keterangannya.</p>
        
        <div style="max-height: 400px; overflow-y: auto;">
            <table class="jurnal-table" id="modalAbsensiTable">
                <thead>
                    <tr>
                        <th style="background-color: #6c757d;">Pilih</th>
                        <th style="background-color: #6c757d;">Nama Siswa</th>
                        <th style="background-color: #6c757d;">Keterangan</th>
                    </tr>
                </thead>
                <tbody id="modalAbsensiBody">
                    </tbody>
            </table>
        </div>
        
        <button onclick="saveAbsensi()" style="margin-top: 20px; padding: 10px 15px; background-color: #1a75ff; color: white; border: none; border-radius: 4px; width: 100%; font-weight: bold;">Simpan Absensi & Hitung Kehadiran</button>
    </div>
</div>

<script>
    // --- JAVASCRIPT LOGIC ---
    
    let jurnalInputCounter = 0; 
    let masterData = {}; 
    let jurnalData = []; 
    let currentJurnalRowId = null; 

    // Fungsi utilitas untuk format tanggal
    function formatTanggalIndonesia(tanggal) {
        const months = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];
        const dateString = tanggal || new Date().toISOString().slice(0, 10);
        const d = new Date(dateString);
        const day = d.getDate();
        const month = months[d.getMonth()];
        const year = d.getFullYear();
        return `${day} ${month} ${year}`;
    }

    function loadMasterData() {
        const rawData = document.getElementById('masterSiswaList').value.trim();
        if (!rawData) { alert("Harap masukkan data siswa!"); return; }

        masterData = {};
        const lines = rawData.split('\n');
        let classes = new Set();

        lines.forEach(line => {
            const parts = line.split('|').map(p => p.trim());
            if (parts.length === 2) {
                const [kelas, nama] = parts;
                if (!masterData[kelas]) { masterData[kelas] = []; }
                if (!masterData[kelas].includes(nama)) {
                    masterData[kelas].push(nama);
                    classes.add(kelas);
                }
            }
        });

        localStorage.setItem('masterData', JSON.stringify(masterData));
        document.getElementById('availableClasses').textContent = Array.from(classes).join(', ');
        alert(`Master Data berhasil dimuat! Ditemukan ${classes.size} kelas.`);
        
        const inputBody = document.getElementById('jurnalInputBody');
        inputBody.innerHTML = ''; 
        initializeJurnalInput();
    }
    
    window.onload = function() {
        const savedMaster = localStorage.getItem('masterData');
        if (savedMaster) {
            masterData = JSON.parse(savedMaster);
            const classes = Object.keys(masterData);
            document.getElementById('availableClasses').textContent = classes.join(', ');
            
            let rawData = '';
            for (const kelas in masterData) {
                masterData[kelas].forEach(nama => {
                    rawData += `${kelas}|${nama}\n`;
                });
            }
            document.getElementById('masterSiswaList').value = rawData.trim();
        } else {
             document.getElementById('masterSiswaList').value = `X IPA 1|Ani Susanti\nX IPA 1|Budi Hartono\nX Mesin 2|Citra Dewi\nX Mesin 2|Dian Permata`;
             loadMasterData();
        }
        
        const savedJurnal = localStorage.getItem('jurnalGuruData');
        if (savedJurnal) {
            jurnalData = JSON.parse(savedJurnal);
        }
        
        displayJurnalTersimpan();
        initializeJurnalInput();
    };
    
    function initializeJurnalInput() {
        if (document.getElementById('jurnalInputBody').rows.length === 0) {
             tambahAgendaBerikutnya();
        }
    }

    function createJurnalRow(data = {}) {
        jurnalInputCounter++;
        const id = 'input-row-' + jurnalInputCounter;
        const body = document.getElementById('jurnalInputBody');

        const classes = Object.keys(masterData);
        let classOptions = classes.map(cls => `<option value="${cls}">${cls}</option>`).join('');

        const defaultData = {
            tanggal: data.tanggal || new Date().toISOString().slice(0, 10),
            jamKe: data.jamKe || '',
            materi: data.materi || '',
            hadir: data.hadir || '0',
            absen: data.absen || '0',
            siswaAbsen: data.siswaAbsen || ''
        };
        
        const newRow = `
            <tr id="${id}">
                <td><input type="date" class="jurnal-tanggal" value="${defaultData.tanggal}"></td>
                <td><input type="text" class="jurnal-jam" placeholder="cth: 1-2" value="${defaultData.jamKe}"></td>
                <td>
                    <select class="jurnal-kelas">
                        <option value="">Pilih Kelas</option>
                        ${classOptions}
                    </select>
                </td>
                <td><input type="text" class="jurnal-materi" value="${defaultData.materi}"></td>
                <td><input type="number" class="jurnal-hadir" value="${defaultData.hadir}" disabled></td>
                <td><input type="number" class="jurnal-absen" value="${defaultData.absen}" disabled></td>
                <td>
                    <input type="text" class="jurnal-siswa-absen" value="${defaultData.siswaAbsen}" disabled>
                    <button class="btn-absen" onclick="showAbsenModal('${id}')">Tambah Siswa Absen</button>
                </td>
                <td>
                    <button class="btn-hapus" onclick="hapusJurnalInput('${id}')">Hapus</button>
                </td>
            </tr>
        `;
        body.insertAdjacentHTML('beforeend', newRow);
        
        if (data.kelas) {
            document.getElementById(id).querySelector('.jurnal-kelas').value = data.kelas;
        }
    }

    function tambahAgendaBerikutnya() { createJurnalRow(); }
    function hapusJurnalInput(id) { if (confirm("Yakin ingin menghapus baris input ini?")) { document.getElementById(id).remove(); } }
    
    function showAbsenModal(rowId) {
        const row = document.getElementById(rowId);
        const kelasInput = row.querySelector('.jurnal-kelas');
        const selectedClass = kelasInput.value;

        if (!selectedClass || !masterData[selectedClass]) {
            alert("Harap pilih Kelas terlebih dahulu dan pastikan Master Data sudah dimuat!");
            return;
        }

        currentJurnalRowId = rowId;
        document.getElementById('modalKelasTarget').textContent = selectedClass;
        
        const students = masterData[selectedClass];
        const tbody = document.getElementById('modalAbsensiBody');
        tbody.innerHTML = '';

        const absenDetailInput = row.querySelector('.jurnal-siswa-absen').value;
        const existingAbsences = {};

        if (absenDetailInput) {
            absenDetailInput.split(';').forEach(detail => {
                const match = detail.trim().match(/(.*)\((A|I|S)\)/);
                if (match) { existingAbsences[match[1].trim()] = match[2]; }
            });
        }

        students.forEach(studentName => {
            const isAbsent = existingAbsences.hasOwnProperty(studentName);
            const keterangan = isAbsent ? existingAbsences[studentName] : 'A';
            
            const rowHTML = `
                <tr>
                    <td><input type="checkbox" data-nama="${studentName}" onchange="toggleKeterangan(this)" ${isAbsent ? 'checked' : ''}></td>
                    <td>${studentName}</td>
                    <td>
                        <select class="keterangan-select" ${isAbsent ? '' : 'disabled'}>
                            <option value="A" ${keterangan === 'A' ? 'selected' : ''}>Alpa</option>
                            <option value="I" ${keterangan === 'I' ? 'selected' : ''}>Izin</option>
                            <option value="S" ${keterangan === 'S' ? 'selected' : ''}>Sakit</option>
                        </select>
                    </td>
                </tr>
            `;
            tbody.insertAdjacentHTML('beforeend', rowHTML);
        });

        document.getElementById('absensiModal').style.display = 'block';
    }

    function closeModal() { document.getElementById('absensiModal').style.display = 'none'; currentJurnalRowId = null; }
    function toggleKeterangan(checkbox) { const select = checkbox.closest('tr').querySelector('.keterangan-select'); select.disabled = !checkbox.checked; }

    function saveAbsensi() {
        if (!currentJurnalRowId) return;

        const modalBody = document.getElementById('modalAbsensiBody');
        const checkboxes = modalBody.querySelectorAll('input[type="checkbox"]:checked');
        const absentStudentsDetail = [];
        let absentCount = 0;

        checkboxes.forEach(checkbox => {
            const studentName = checkbox.dataset.nama;
            const select = checkbox.closest('tr').querySelector('.keterangan-select');
            const reason = select.value;

            absentStudentsDetail.push(`${studentName} (${reason})`);
            absentCount++;
        });

        const absenDetailString = absentStudentsDetail.join('; ');
        const row = document.getElementById(currentJurnalRowId);
        
        row.querySelector('.jurnal-siswa-absen').value = absenDetailString;
        row.querySelector('.jurnal-absen').value = absentCount;
        
        const selectedClass = row.querySelector('.jurnal-kelas').value;
        const totalSiswa = masterData[selectedClass] ? masterData[selectedClass].length : 0;
        row.querySelector('.jurnal-hadir').value = totalSiswa - absentCount;

        closeModal();
    }
    
    function simpanAgenda() {
        const rows = document.getElementById('jurnalInputBody').rows;
        if (rows.length === 0) { alert("Tidak ada jurnal untuk disimpan!"); return; }

        let hasError = false;

        for (let i = 0; i < rows.length; i++) {
            const row = rows[i];
            
            const jurnalEntry = {
                id: Date.now() + i,
                tanggal: row.querySelector('.jurnal-tanggal').value,
                jamKe: row.querySelector('.jurnal-jam').value,
                kelas: row.querySelector('.jurnal-kelas').value,
                materi: row.querySelector('.jurnal-materi').value,
                hadir: parseInt(row.querySelector('.jurnal-hadir').value) || 0,
                absen: parseInt(row.querySelector('.jurnal-absen').value) || 0,
                siswaAbsen: row.querySelector('.jurnal-siswa-absen').value
            };
            
            if (!jurnalEntry.tanggal || !jurnalEntry.kelas || !jurnalEntry.materi) {
                alert(`Baris ke-${i + 1}: Tanggal, Kelas, dan Materi wajib diisi.`);
                hasError = true;
                break;
            }
            
            jurnalData.push(jurnalEntry);
        }
        
        if (hasError) return;

        localStorage.setItem('jurnalGuruData', JSON.stringify(jurnalData));
        document.getElementById('jurnalInputBody').innerHTML = '';
        initializeJurnalInput();
        displayJurnalTersimpan();
        alert("Agenda Berhasil Disimpan!");
    }

    function displayJurnalTersimpan() {
        const tbody = document.getElementById('jurnalTersimpanBody');
        tbody.innerHTML = ''; 

        jurnalData.forEach(jurnal => {
            const row = tbody.insertRow();
            row.insertCell().textContent = jurnal.tanggal;
            row.insertCell().textContent = jurnal.jamKe;
            row.insertCell().textContent = jurnal.kelas;
            row.insertCell().textContent = jurnal.materi.substring(0, 50) + (jurnal.materi.length > 50 ? '...' : '');
            row.insertCell().textContent = jurnal.hadir;
            row.insertCell().textContent = jurnal.absen;
            row.insertCell().textContent = jurnal.siswaAbsen;

            const actionCell = row.insertCell();
            actionCell.innerHTML = `<button class="btn-hapus" onclick="hapusJurnalTersimpan(${jurnal.id})">Hapus</button>`;
        });
    }

    function hapusJurnalTersimpan(id) {
        if (confirm("Apakah Anda yakin ingin menghapus jurnal yang sudah tersimpan ini?")) {
            jurnalData = jurnalData.filter(jurnal => jurnal.id !== id);
            localStorage.setItem('jurnalGuruData', JSON.stringify(jurnalData));
            displayJurnalTersimpan();
            alert("Jurnal Berhasil Dihapus.");
        }
    }

    // FUNGSI CETAK JURNAL (Diperbarui untuk NIP Guru dan Kepsek)
    function cetakJurnal() {
        // 1. Ambil Data
        const tempat = document.getElementById('tempatLaporan').value;
        const todayDate = formatTanggalIndonesia(new Date()); 
        const namaGuru = document.getElementById('namaGuru').value;
        const nipGuru = document.getElementById('nipGuru').value;
        const namaKepsek = document.getElementById('namaKepalaSekolah').value;
        const nipKepsek = document.getElementById('nipKepalaSekolah').value;

        // 2. Update Info Header & Tempat/Tanggal Laporan
        document.getElementById('printNamaGuru').textContent = namaGuru;
        document.getElementById('printMapel').textContent = document.getElementById('mapel').value;
        document.getElementById('printSekolah').textContent = document.getElementById('sekolah').value;
        document.getElementById('printTahunPelajaran').textContent = document.getElementById('tahunPelajaran').value;
        
        document.getElementById('ttdTempatTanggal').textContent = `${tempat}, ${todayDate}`;

        // 3. Update Bagian Tanda Tangan (NAMA dan NIP)
        document.getElementById('ttdNamaGuruTTD').textContent = `( ${namaGuru} )`;
        document.getElementById('ttdNipGuru').textContent = `NIP: ${nipGuru}`;
        
        document.getElementById('ttdNamaKepsek').textContent = `( ${namaKepsek} )`;
        document.getElementById('ttdNipKepsek').textContent = `NIP: ${nipKepsek}`;

        // 4. Salin Jurnal Tersimpan ke Area Cetak
        const printTable = document.getElementById('printTableBody');
        printTable.innerHTML = '';
        
        printTable.innerHTML = `
            <thead>
                <tr>
                    <th>TANGGAL</th>
                    <th>JAM KE-</th>
                    <th>KELAS</th>
                    <th>MATERI</th>
                    <th>Hadir</th>
                    <th>Absen</th>
                    <th>NAMA SISWA TIDAK HADIR (S/I/A)</th>
                </tr>
            </thead>
            <tbody></tbody>
        `;
        const printTbody = printTable.querySelector('tbody');

        jurnalData.forEach(jurnal => {
            const row = printTbody.insertRow();
            row.insertCell().textContent = jurnal.tanggal;
            row.insertCell().textContent = jurnal.jamKe;
            row.insertCell().textContent = jurnal.kelas;
            row.insertCell().textContent = jurnal.materi;
            row.insertCell().textContent = jurnal.hadir;
            row.insertCell().textContent = jurnal.absen;
            row.insertCell().textContent = jurnal.siswaAbsen;
        });

        window.print();
    }
</script>

</body>
</html>
